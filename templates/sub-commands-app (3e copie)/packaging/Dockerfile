############################################
# {{ cookiecutter.project_name }} {{ cookiecutter.version }}
# author: {{ cookiecutter.full_name }}
# url: https://{{ cookiecutter.git_remote}}/{{ cookiecutter.git_username }}/{{ cookiecutter.git_namespace }}
# Autogenerated with https://github.com/microservice-core/project-builder
# Uages :
# -------
# Pull
# {{ cookiecutter.docker_pull_cmd }}
# Run from registry
# {{ cookiecutter.docker_run_cmd }}
# Build localy
# {{ cookiecutter.docker_build_cmd }}
############################################

{% if cookiecutter.python|lower == "y" %}
FROM python:3-onbuild
WORKDIR /usr/src/app/sources
CMD [ "sh", "run.sh" ]
EXPOSE 80

{% else %}
FROM ubuntu:latest
RUN \
  apt-get update && \
  apt-get -y upgrade

RUN \
  apt-get -y install {{ cookiecutter.docker_tool }}

ENV TARGET=127.0.0.1

{% if cookiecutter.torified == "y" %}
RUN \
  apt-get -y install tor && \
  apt-get -y install proxychains && \
  apt-get -y install polipo

{% if cookiecutter.docker_scanner == "y" %}
CMD \
    service tor start && \
    service polipo start && \
    proxychains {{ cookiecutter.docker_command }} $TARGET
{% else %}
CMD \
    service tor start && \
    service polipo start && \
    proxychains {{ cookiecutter.docker_command }}
{% endif %}
{% elif cookiecutter.docker_scanner == "y" %}
CMD {{ cookiecutter.docker_command }} $TARGET
{% else %}
CMD {{ cookiecutter.docker_command }}
{% endif %}
{% endif %}
